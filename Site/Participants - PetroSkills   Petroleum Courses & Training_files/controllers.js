function LightBoxToggle(e){if(e)$("#light-box-iframe").fadeIn("fast");else{var t=jQuery("html"),n=t.data("scroll-position");t.css("overflow",t.data("previous-overflow")),window.scrollTo(n[0],n[1]),$("#light-box-curtain, #light-box-iframe").fadeOut("fast")}}define("controllers/Accordian",[],function(){var e={Build:function(e,t){var n=t.selected||0,r=this;$(".accordian .accordianButton",e).each(function(e){r.accordianList.push({button:$(this)})}),$(".accordian .accordianContent",e).each(function(e){r.accordianList[e].content=$(this)});var i=this.accordianList.length==1?!0:!1;for(var s=0;s<this.accordianList.length;s++)this.BindAccordian(s,i);i||this.SelectContent(n)},BindAccordian:function(e,t){var n=this;t?$(this.accordianList[e].button).bind("click",function(){n.ContentVisible(e)?n.HideAllContent():n.SelectContent(e)}):$(this.accordianList[e].button).bind("click",function(){n.HideAllContent(),n.SelectContent(e)})},ContentVisible:function(e){return this.accordianList[e].content.is(":visible")},HideAllContent:function(){for(var e=0;e<this.accordianList.length;e++)this.ContentVisible(e)&&(this.accordianList[e].content.slideUp().removeClass("selected"),this.accordianList[e].button.removeClass("selected"))},SelectContent:function(e){this.ContentVisible(e)||(this.accordianList[e].content.slideDown().addClass("selected"),this.accordianList[e].button.addClass("selected"))},accordianList:[]};return e}),define("controllers/AjaxContainer",[],function(){var e={Build:function(e,t){this.element=e,t.loader=t.loader||"small",t.url=t.url||window.location.href,t.dataType=t.dataType||"html";var n=this;this.settings=t,this.element.bind("reload",function(e,t){n.Reload(t)}),(t.autoLoad===undefined||t.autoLoad)&&this.Reload()},Success:function(e,t,n,r){this.element.html(t),window.controlManager.FindControls(this.element),e.callback!==undefined&&e.callback(!0,t)},Reload:function(e){var t=this;e=e||{},e=$.extend(e,this.settings),e.success=function(n,r,i){t.Success(e,n,r,i)},this.settings.loader!="none"&&this.element.html('<div style="text-align:center;"><img src="/assets/icons/ajax-loader-'+this.settings.loader+'.gif" /></div>'),$.ajax(e)},element:null,settings:null};return e}),define("controllers/CartFieldList",[],function(){var e={validationMethods:{email:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},otherField:function(e){var t=$("option[value="+$("select[name=referral]").val()+"]","select[name=referral]").text();return e||t!="Other"}},changeMethods:{referral:function(e,t){var n=$("option[value="+e.val()+"]","select[name=referral]").text();console.log(n),n==="Other"?($("#otherField").slideDown(),$("input[name=otherField]").focus()):($("#otherField").slideUp(),$("input[name=otherField]").val(""))}},autoCorrect:{},UpdateField:function(e,t){var n=e.val();t!==undefined&&(n=t),this.SendFieldUpdate(e.attr("data-field"),n)},AddField:function(e,t){var n=this;this.fieldGroups[e].push(t),t.data("pvalue",t.val()),t.attr("type")&&t.attr("type")==="checkbox"?t.click(function(){n.UpdateField(t,$(this).is(":checked"))}):t.attr("type")&&t.attr("type")==="radio"?t.click(function(){n.UpdateField(t,$(this).val())}):(t.blur(function(){t.val()!==t.data("pvalue")&&n.ValidateField(t)&&(t.data("pvalue",t.val()),n.UpdateField(t)),t.val()===""&&n.ValidateField(t)}),this.autoCorrect[t.attr("data-field")]&&t.keyup(function(){n.autoCorrect[t.attr("data-field")](this)}),this.changeMethods[t.attr("data-field")]&&t.change(function(){n.changeMethods[t.attr("data-field")](t,this)}))},AddFieldGroup:function(e){var t=this,n=e.attr("data-group");this.fieldGroups[n]=[],e.attr("data-groupCopy")&&$("[data-field='"+e.attr("data-groupCopy")+"']",e).click(function(){$(this).is(":checked")?$(".groupContents",e).hide(500):$(".groupContents",e).show(500),$("[data-field]",e).each(function(){$(this).val("")})}),$("[data-field]",e).each(function(){t.AddField(n,$(this))})},BuildFieldList:function(){var e=this;$("[data-group]",this.element).each(function(){e.AddFieldGroup($(this))})},ValidateFields:function(){var e=!0;for(var t in this.fieldGroups)for(var n=0;n<this.fieldGroups[t].length;n++)this.ValidateField(this.fieldGroups[t][n])||(e=!1);return e},ValidateField:function(e){var t=!1;return e.is(":hidden")?!0:e.attr("type")==="checkbox"?!0:(e.val()!==""&&(this.validationMethods[e.attr("data-field")]!==undefined?t=this.validationMethods[e.attr("data-field")](e.val()):t=!0),e.attr("data-validation")==="off"&&(t=!0),t?e.css({"background-color":""}):e.css({"background-color":"#dd9999"}),t)},fieldGroups:{}};return e}),define("controllers/DateWidget",[],function(){var e={Build:function(e,t){$(t.input).Zebra_DatePicker({always_visible:$(t.container)}),$("table.dp_header, table.dp_footer, table.dp_daypicker, table.dp_monthpicker, table.dp_yearpicker",e).width("315px")}};return e}),define("controllers/EmailAFriend",[],function(){var EmailAFriend={Build:function(e,t){var n=this;this.form=$(".form",e),this.name=$("#emailFormName",e),this.email=$("#emailFormEmail",e),this.message=$("#emailFormMessage",e),$("input[name=courseId]",e).length?this.id=$("input[name=courseId]",e):this.id=$("input[name=sessionId]",e),this.url=$("input[name=url]",e),this.submit=$("#emailFormSubmit",e),this.cancel=$("#emailFormCancel",e),this.loader=$('<div class="loader"></div>').appendTo(e),this.finish=$('<div class="finish"></div>').appendTo(e),this.popup=$(e).parent();while(!this.popup.hasClass("modalWindow"))this.popup=this.popup.parent();this.submit.click(function(){n.FormSubmit()}),this.cancel.click(function(){n.FormCancel()})},FormSubmit:function(){var self=this,post={formId:"emailForm",emailFormName:this.name.val(),emailFormEmail:this.email.val(),emailFormMessage:this.message.val(),url:this.url.val()};post[this.id.attr("name")]=this.id.val(),this.Loader(),$.post("/api/email-a-friend",post,function(response){eval("response = {"+response+"}"),response.success=="true"?self.Finish(response.message):($(".errors",self.form).html(response.message),self.Loader())})},FormCancel:function(){this.email.val(""),this.message.val(""),$(".errors",this.form).html(""),this.popup.trigger("close")},Loader:function(){this.form.is(":visible")?(this.form.hide(),this.loader.fadeIn("slow")):(this.loader.hide(),this.form.fadeIn("slow"))},Finish:function(e){var t=this;this.loader.hide(),this.finish.html(e).fadeIn("slow"),setTimeout(function(){t.FormCancel(),t.finish.hide(),t.email.val(""),t.message.val(""),$(".errors",t.form).html(""),t.form.show()},2e3)},form:null,email:null,message:null,submit:null,cancel:null,loader:null,finish:null};return EmailAFriend}),define("controllers/GreyCel",[],function(){var e={Build:function(e,t){var n=this;this.element=e,$(t.cells,this.element).each(function(){var e=$(this);n.cells.push(e),e.bind("greyOut",function(){n.GreyOutNonClassed()})}),this.imageQuery=t.image,this.ignoreClass=t.byClass,this.GreyOutNonClassed()},element:null,cells:[],imageQuery:"",ignoreClass:"",GreyOutNonClassed:function(){for(var e=0;e<this.cells.length;e++)!this.cells[e].hasClass(this.ignoreClass)&&!this.cells[e].hasClass("greyed")?(this.cells[e].addClass("greyed"),Pixastic.process($(this.imageQuery,this.cells[e]).get(0),"desaturate",{average:!1})):this.cells[e].hasClass(this.ignoreClass)&&this.cells[e].hasClass("greyed")&&(this.cells[e].removeClass("greyed"),Pixastic.revert($("canvas",this.cells[e]).get(0)))}};return e}),define("controllers/HeaderRotation",[],function(){var e={Build:function(e,t){var n=this;this.autoScroll=t.autoScroll!==undefined?t.autoScroll:!0,$("figure",e).each(function(e){var t=$(this);n.slideImages[e]=t.attr("data-imageBackground"),n.slides.push(t),button=$(".rotation-blocks .tab"+e),n.buttons.push(button)}),$("div.right",e).click(function(){n.HeaderRotate("forward")}),$("div.left",e).click(function(){n.HeaderRotate("backward")}),this.itr=0,this.autoScroll&&(this.interval=setInterval(function(){n.ChangeSlide("forward")},8e3));for(var r=0;r<4;r++)$("<img/>")[0].src=this.slideImages[r]},HeaderRotate:function(e){var t=this;clearInterval(this.interval),this.ChangeSlide(e),this.autoScroll&&(this.interval=setInterval(function(){t.ChangeSlide("forward")},8e3))},ChangeSlide:function(e){e=this.SetIteration(e);if(e!==!1){$("section.body").css("background-image","url('"+this.slideImages[e]+"')"),$(".tabset-ctypes").removeClass("selected"),this.buttons[e].addClass("selected");for(var t=0;t<4;t++)this.slides[t].hasClass("selected")&&this.slides[t].removeClass("selected").hide();this.slides[e].fadeIn("slow").addClass("selected"),console.log(this.slides[e])}},SetIteration:function(e){return e=="forward"?this.itr==this.slides.length-1?e=0:e=this.itr+1:e=="backward"&&(this.itr==0?e=this.slides.length-1:e=this.itr-1),e==this.itr?!1:(this.itr=e,e)},slides:[],slideImages:[],buttons:[],autoScroll:null,interval:null,itr:null};return e}),define("controllers/LightBox",[],function(){var e={Build:function(e,t){var n=this;this.url=t.url||$(e).attr("href"),$("#light-box-curtain").is("div")?(this.curtain=$("#light-box-curtain"),this.lightBox=$("#light-box-iframe")):(this.curtain=$('<div id="light-box-curtain"></div>').appendTo("body"),this.lightBox=$('<iframe id="light-box-iframe"></div>').appendTo("body")),e.click(function(e){$(this).is("a")&&e.preventDefault(),n.LightBoxUp(n.url)})},LightBoxUp:function(e){var t=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop],n=jQuery("html");n.data("scroll-position",t),n.data("previous-overflow",n.css("overflow")),n.css("overflow","hidden"),window.scrollTo(t[0],t[1]),this.curtain.show().css({left:t[0],top:t[1]}),this.lightBox.attr("src")==e?(this.lightBox.css({left:t[0],top:t[1]}),LightBoxToggle(!0)):e.indexOf("light-box=true")>0?this.lightBox.css({left:t[0],top:t[1]}).attr("src",e):this.lightBox.css({left:t[0],top:t[1]}).attr("src",e).load(function(){parent.LightBoxToggle(!0)})},url:null,lightBox:null,curtain:null};return e}),define("controllers/LightBoxPage",[],function(){var e={Build:function(e,t){$(e).addClass("light-box"),$("header.body").hide(),$("section.hadjust").css("background","none"),$("header.market-menu").hide(),$("footer.body").hide();var n='<section class="light-box-button-wrapper clearfix"><button type="button" class="grey thin" onclick="parent.LightBoxToggle();">CLOSE</button></section>';$("section.blocks",e).is("selection")?$("section.blocks",e).append(n).prepend(n):$("section.body",e).append(n).prepend(n),parent.LightBoxToggle(!0)}};return e}),define("controllers/LinkList",[],function(){var e={Build:function(e,t){this.element=e,$("a.light-box",e).each(function(){a=$(this),url=a.attr("href"),a.attr("data-control","LightBox{`url`:`"+url+"`}").click(function(e){e.preventDefault()}),window.controlManager.FindControls(this)})},element:null};return e}),define("controllers/MenuLink",[],function(){var e={Build:function(e,t){e.click(function(){$("> a",this)[0].click()})}};return e}),define("controllers/Placeholder",[],function(){var e={Build:function(e,t){this.element=e,this.text=t.text;var n=this;$(this.element).bind("blur",function(){$(this).val()===""&&($(this).val(n.text),$(this).addClass("placeholder"))}),$(this.element).trigger("blur"),$(this.element).bind("focus",function(){$(this).val()===n.text&&$(this).val("")}),$(this.element).bind("click keydown keyup keypress blur change",function(){$(this).val()===n.text?($(this).addClass("placeholder"),$(this).select()):$(this).removeClass("placeholder")})},text:null,element:null};return e}),define("controllers/PopupBox",[],function(){var e={Build:function(e,t){var n=this;this.element=e,this.settings=t,this.action=t.action||"mouseenter",this.box=$(".popupBox",this.element),this.box.append($('<div class="pointer"></div>')),this.box.appendTo("body"),$(".popupElement",this.element).bind(this.action,function(){n.box.is(":visible")?n.action!="mouseenter"&&n.CloseBox(!0):n.OpenBox()}),this.box.hover(function(){n.CancelClose()},function(){n.CloseBox()}),$(".popupElement",this.element).hover(function(){n.box.is(":visible")&&n.CancelClose()},function(){n.box.is(":visible")&&n.CloseBox()})},OpenBox:function(){this.CancelClose(),$(".popupBox").hide(),this.PositionBox(),this.box.fadeIn("slow")},CloseBox:function(e){if(e)this.box.fadeOut("fast");else{var t=this;this.timer=setTimeout(function(){t.box.fadeOut("fast")},1e3)}},CancelClose:function(){this.timer&&clearTimeout(this.timer)},PositionBox:function(){var e=$(".popupElement",this.element),t=e.offset(),n=$(".pointer",this.box),r=t.left+e.outerWidth()+n.outerWidth(),i=t.left-this.box.outerWidth()-n.outerWidth();if((i>15||this.settings.alwaysLeft)&&!this.settings.alwaysRight){var s=i;n.css({transform:"none",left:this.box.outerWidth()})}else{var s=r;n.css({transform:"rotate(180deg)",left:-n.outerWidth()})}var o=t.top+e.outerHeight()/2;this.box.outerHeight()<100?(topPosition=o-this.box.outerHeight()/2,n.css({top:this.box.outerHeight()/2-n.height()/2})):(topPosition=o-50,n.css({top:43})),this.box.css({top:topPosition,left:s})},action:null,element:null,box:null,timer:null,settings:null};return e}),define("controllers/PopupPage",[],function(){var e={Build:function(e,t){this.element=e},element:null};return e}),define("controllers/ProgressionMap",[],function(){var e={Build:function(e,t){$("td.cell div a",e).each(function(e){var t=$(this).parent();$(this).css({position:"absolute",top:Math.round((t.height()-$(this).outerHeight())/2)+"px"}).hover(function(){t.addClass("hover")},function(){t.removeClass("hover")})})}};return e}),define("controllers/Purchaser",["controllers/CartFieldList"],function(e){var t={Build:function(t,n){this.element=t,$.extend(!0,this,e),this.BuildFieldList(),register.SetPurchaser(this)},element:null,SendFieldUpdate:function(e,t){register.UpdatePurchaserField(e,t,function(){$(".registrant").each(function(){($("input[name='isPurchaser']",this).is(":checked")||$("input[name='companyIsPurchaser']",this).is(":checked"))&&$(this).trigger("checkValidation")})})}};return t}),define("controllers/Registrant",["controllers/CartFieldList"],function(e){var t={Build:function(t,n){this.uid=n.uid,this.sessionId=n.sessionId,this.element=t;var r=this;this.element.bind("checkValidation",function(){r.CheckValidation()}),$.extend(!0,this,e),this.BuildFieldList(),register.AddRegistrant(this)},uid:"",element:null,sessionId:"",ReloadGroup:function(e){delete this.fieldGroups[e],this.AddFieldGroup($("[data-group='"+e+"']",this.element))},BuildDataReturn:function(e){var t=this;if(e.clientIdMessage!==undefined)if(e.clientIdMessage!==!1){var n=$('<label for="clientIdValue"></label>');n.html(e.clientIdMessage);var r=$('<input data-field="clientIdValue" type="text" name="clientIdValue" data-validation="off" value="" />');$("[data-group='clientId']",t.element).append(n).append(r),t.ReloadGroup("clientId")}else e.clientIdMessage===!1&&$("[data-group='clientId']",t.element).empty();if(e.isShell){if($("#hasShellClientCheck",t.element).length===0){var i=$('<label id="hasShellClientCheck" for="isShellClient">Is this for Shell?</label>Yes  <input type="radio" name="isShellClient" data-field="isShellClient" value="Yes" /> No <input type="radio" name="isShellClient" data-field="isShellClient" value="No" />');$("[data-group='shellClient']",t.element).append(i),t.ReloadGroup("shellClient")}}else $("[data-group='shellClient']",t.element).empty()},SendFieldUpdate:function(e,t){var n=this;register.UpdateParticipantField(this.sessionId,this.uid,e,t,function(e){n.BuildDataReturn(e)})},CheckValidation:function(){var e=this;register.UpdateParticipantField(this.sessionId,this.uid,null,null,function(t){e.BuildDataReturn(t)})}};return t}),define("controllers/Search",[],function(){var e={Build:function(e,t){this.input=$("input[type='text']",e),this.input.bind("keyup, keydown, keypress",function(t){t.keyCode==13&&(t.preventDefault(),t.stopPropagation(),$(".submit",e).trigger("click"))});var n=this;$("button.submit",e).click(function(){$("#SearchContents").trigger("reload",{data:{keywords:n.input.val()},callback:n.BindLinks.bind(n)})}),this.BindLinks()},BindLinks:function(){var e=this;$("a.pagerLink").click(function(){var t=this.id.replace("pager","");$("#SearchContents").trigger("reload",{data:{keywords:e.input.val(),page:t},callback:e.BindLinks.bind(e)})})},input:null};return e}),define("controllers/SearchField",[],function(){var e={Build:function(e,t){this.element=e,this.type=t.type,this.identifier=t.identifier;var n="",r=this;this.element.attr("type")==="checkbox"?(this.element.data("lastValue",$(this.element).is(":checked")),$(this.element).bind("change",function(){r.SetValue($(this).is(":checked"))})):(this.element.attr("type")==="hidden"&&setInterval(function(){r.element.data("lastValue")!==r.element.val()&&r.element.trigger("change")},250),this.element.data("lastValue",$(this.element).val()),$(this.element).bind("change",function(){r.SetValue($(this).val())}))},element:null,type:"",identifier:"",SetValue:function(e){this.element.data("lastValue")!==e&&(this.element.data("lastValue",e),search.UpdateSearch(this.type,this.identifier,e))}};return e}),define("controllers/SearchForm",[],function(){var e={Build:function(e,t){$("input[type='text']",e).bind("keyup, keydown, keypress",function(t){t.keyCode==13&&(t.preventDefault(),t.stopPropagation(),$(".submit",e).trigger("click"))})}};return e}),define("controllers/TabPanel",[],function(){var e={Build:function(e,t){t.selected=t.selected||0,this.element=e;var n=this;$(".tab-buttons .tab",e).each(function(e){n.BindTab($(this),e)}),this.buttonContainer=$(".tab-buttons",e),this.tabContainer=$(".tabs",e),this.HideAllTabs(),this.SelectTab(t.selected,$(".tab:eq("+t.selected+")",this.buttonContainer))},BindTab:function(e,t){var n=this;$(e).bind("click",function(){n.HideAllTabs(),n.SelectTab(t,$(this))})},HideAllTabs:function(){$(".tab",this.buttonContainer).removeClass("selected"),$(".tab",this.tabContainer).hide(0).removeClass("selected")},SelectTab:function(e,t){t.attr("data-tab")&&(e=parseInt(t.attr("data-tab"))),$(".tab:eq("+e+")",this.tabContainer).show(0).addClass("selected"),t.addClass("selected")},element:null,buttonContainer:null,tabContainer:null};return e}),define("controllers/TmsMenuData",[],function(){var e={Build:function(e,t){var n={};this.model=t.model,this.dataArray=t.dataArray,this.rows=t.rows,this.element=e,this.text=t.text,this.link=t.link||"#",this.value=t.value||"",this.allowCache=t.cache||this.allowCache,this.callback=t.callback||null,this.emptyMessage=t.emptyMessage||!1,this.BindTrigger(),t.activation&&this.Activate()},cache:{},model:"",dataArray:"",element:null,rows:null,text:"",link:"",value:"",allowCache:!1,callback:null,emptyMessage:null,BindTrigger:function(){var e=this;this.element.bind("activateMenu",function(t,n){e.Activate(n)})},Success:function(e,t){this.allowCache&&(this.cache[t]=e),this.Render(e),this.callback!==null},Render:function(e){var t=$.extend(!0,{},e),n=this.dataArray.split(".");for(var r=0;r<n.length;r++)t=t[n[r]];var i=parseInt(t.length/this.rows.length,10),s=t.length%this.rows.length+i,o=[];for(var u=0;u<this.rows.length;u++){var a=i;u===0&&(a=s),o.push(t.splice(0,a))}for(u=0;u<o.length;u++){var f=$(this.rows[u],this.element);f.empty(),f.css("overflow-y",o[u].length>20?"auto":"hidden");if(o[u].length)for(var l=0;l<o[u].length;l++){if(typeof this.value=="string")var c=this.link.replace("[[value]]",o[u][l][this.value]);else{var c=this.link;for(var r=0;r<this.value.length;r++)c=c.replace("[[value"+(r+1)+"]]",o[u][l][this.value[r]])}f.append($('<li><a href="'+c+'">'+o[u][l][this.text]+"</a></li>"))}else this.emptyMessage&&f.append("<li>"+this.emptyMessage+"</li>")}},Update:function(e){var t=this,n=this.CreateCacheString(e);e.model=e.model||this.model,$.ajax("/api/tms-rtl",{dataType:"json",data:e,type:"POST",success:function(r){t.Success(r,n),e.model==="LocationList"&&($(".allArea",t.element).empty(),$(".allArea",t.element).append("<button class='blue thin' onclick=\"window.location.href='/search?setSearch=true&Region="+e.extPath+"'\">All Locations in Region</button>"))}})},Activate:function(e){e=e||{},this.HasCache(e)?this.Render(this.cache[this.CreateCacheString(e)]):this.Update(e)},HasCache:function(e){return this.allowCache&&this.cache[this.CreateCacheString(e)]!==undefined},CreateCacheString:function(e){var t=[];for(var n in e)t.push(n+"="+e[n]);var r=t.join("&");return r===""?"empty":r}};return e}),define("controllers/FormSelector",[],function(){var e={Build:function(e,t){this.blockColor=t.blockColor?t.blockColor:this.blockColor;var n=this,r=!1;$("input[type=radio]",e).each(function(){var e=$(this).val(),t=$("#"+e);t.addClass("formSelector").css("position","relative");var i=$('<div class="formCover"></div>').css({position:"absolute",top:0,left:0,opacity:.7,"background-color":n.blockColor,"z-index":4e3}).appendTo(t);$(this).attr("checked")&&(r=e),$(this).click(function(){n.EnableForm(e)})}),this.EnableForm(r)},EnableForm:function(e){$(".formSelector").removeClass("selected").each(function(){$(".formCover",this).css({height:$(this).outerHeight(),width:$(this).outerWidth()}).fadeIn()});if(e){var t=$("#"+e);t.addClass("selected"),$(".formCover",t).fadeOut()}},blockColor:"#FFF"};return e}),define("controllers/Popup",[],function(){var e={Build:function(e,t){var n=this;if($("#overlay").length<1){var r=$('<div id="overlay"></div>');r.appendTo("body").hide()}t.modal=t.modal===undefined?!0:t.modal,t.id=t.id||$(e).attr("id"),this.element=e,this.overlay=$("#overlay"),this.overlay.append(e),t.url&&($(".content",e).length?this.content=$(".content",e):this.content=$('<div class="content"></div>').appendTo(e),this.content.attr("data-control","AjaxContainer{ `url`:`"+t.url+"`,`autoLoad`:false}"),window.controlManager.FindControls(this.content),$(e).bind("ajaxload",function(e){e.complete=function(){n.Position()},n.content.trigger("reload",e)})),$(e).bind("open",function(){var t=$(".modalWindow:visible");if(t.length){var r=!1;t.each(function(){$(this).attr("id")==$(e).attr("id")&&(r=!0)});if(r)return;n.otherWindow=t,t.hide()}else{var i=jQuery("html"),s=[n.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];i.data("scroll-position",s),i.data("previous-overflow",i.css("overflow")),i.css("overflow","hidden"),window.scrollTo(s[0],s[1]);var o=$(window).width(),u=$(window).height();n.overlay.css({left:s[0],top:s[1],width:o,height:u}).fadeIn(200),$(window).bind("resize",function(){$(e).trigger("position")})}n.content&&!n.content.html()&&$(e).trigger("ajaxload"),n.Position(),$(e).fadeIn(200)}),$(e).bind("close",function(){if(n.otherWindow!==null)n.element.hide(),n.otherWindow.fadeIn(200),n.otherWindow=null;else{var t=$("html"),r=t.data("scroll-position");n.overlay.fadeOut(200),$(e).fadeOut(200),t.css("overflow",t.data("previous-overflow")),window.scrollTo(r[0],r[1]),n.moveInterval!==null&&(clearInterval(n.moveInterval),n.moveInterval=null),$(window).unbind("resize",function(){$(e).trigger("position")})}}),$(e).bind("position",function(){n.Position()}),$(e).bind("remove",function(){$(e).trigger("remove"),window.popupFactory.RemovePopup(t.id)}),$("> div, > section",e).addClass("windowcontent"),$(".closebutton, .cancelbutton, .close, .cancel",e).each(function(){$(this).click(function(){$(e).trigger("close")})})},Position:function(){var e=$(this.element),t=$(window).width(),n=$(window).height();this.overlay.css({width:t,height:n}),e.outerHeight()<n?e.css("margin-top",Math.floor(n/2-e.outerHeight()/2)+"px"):e.css("margin-top","10px")},overlay:null,moveInterval:null,element:null,otherWindow:null,content:null};return e}),define("controllers/Validation",[],function(){var e={element:null,errors:[],_validationFailedColor:"#ff9999",Build:function(e,t){this.element=$(e);var n=this;this.element.on("submit",function(e){n.Submit(e)})},Submit:function(e){var t=this;$("input, select, textarea",this.element).each(function(){var e=$(this),n=[],r=e.attr("data-validate");if(r!==undefined&&r!==!1){var i=r.split(" ");for(var s=0;s<i.length;s++){var o=t[t.UcFirst(i[s])].bind(t);if(o){var u=o(e);u&&n.push(u)}}if(n.length){for(var a=0;a<n.length;a++)t.errors.push(n[a]);e.data("background",e.css("background")),e.css("background",t._validationFailedColor)}else e.data("background")!==undefined&&e.css("background",e.data("background"))}}),this.SetErrors()&&e.preventDefault()},SetErrors:function(){var e=$("ul.errors",this.element);if(this.errors.length){e.length||(e=$('<ul class="errors"></ul>').hide().prependTo(this.element));var t="";for(var n=0;n<this.errors.length;n++)t+="<li>"+this.errors[n]+"</li>";return e.html(t).show(),this.errors=[],!0}return e.hide(),!1},GetLabel:function(e){var t=e.attr("name"),n=$("[for="+t+"]");return n.length?$.trim(n.text().replace(":","").replace("*","")):this.UcFirst(t.replace("_"," ").replace("-"," "))},UcFirst:function(e){var e=$.trim(e);return e.charAt(0).toUpperCase()+e.slice(1)},Required:function(e){var t=e.val();if(t===""||t===null)return this.GetLabel(e)+" is a required field."},Email:function(e){if(!e.val().match(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i))return this.GetLabel(e)+" is not a valid email address."}};return e});